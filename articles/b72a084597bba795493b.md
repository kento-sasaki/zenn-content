---
title: "å­¦ã³ãªãŒã‚‰Reactç’°å¢ƒæ§‹ç¯‰"
emoji: "ğŸ¡"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["react"]
published: true
---

# ã“ã‚Œã¯ä½•ï¼Ÿ
React + TypeScriptã§ã‚¢ãƒ—ãƒªã‚’é–‹ç™ºã™ã‚‹æ™‚ã€æœ€ä½é™ã®ç’°å¢ƒæ§‹ç¯‰æ–¹æ³•ã‚’è‡ªåˆ†ã®å‚™å¿˜éŒ²ã‚‚å…¼ã­ã¦è¨˜äº‹ã«ã—ãŸã‚‚ã®ã§ã™ã€‚

# create-react-app
ã¾ãšã¯`create-react-app`ã§ã™ã€‚
Ruby on Railsã®`rails new`ã¿ãŸã„ãªã‚³ãƒãƒ³ãƒ‰ã§ã™ã­ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹å§‹ã™ã‚‹ã¨ãã«ã„ã„æ„Ÿã˜ã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ãã‚Œã¾ã™ã€‚
ã—ã‹ã‚‚Jestã‚„React-Testing-Libraryã‚‚ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ãã‚Œã¦ã„ã¾ã™ã€‚ç´ æ•µã§ã™ã­ã€‚

```
$ mkdir <App Name> && cd <App Name>
$ yarn create react-app . --template typescript
```

# ESLint
JavaScriptã®Linterã§ã‚ã‚‹ESLintã§ã™ã€‚
TypeScriptã®å ´åˆTSLintã§æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ã‚‚å¯èƒ½ã§ã™ãŒã€ç¾åœ¨ã¯éæ¨å¥¨ã«ãªã£ã¦ã„ã‚‹ã®ã§ESLintã§æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†ã€‚

ã¾ãšã¯ESLintã¨å„ç¨®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
```
$ yarn add -D eslint
$ yarn add -D @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint-plugin-jest eslint-plugin-react eslint-plugin-react-hooks
$ yarn eslint --init
```

`yarn eslint --init`ã§è³ªå•ã«ç­”ãˆãªãŒã‚‰ESLintã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«`.eslintrc.js`ã‚’ä½œæˆã—ã¾ã™ã€‚
å‡ºæ¥ä¸ŠãŒã£ãŸ`.eslintrc.js`ã«è‰²ã€…ã¨è¿½è¨˜ã—ã¾ã™ã€‚
```js
module.exports = {
  env: {
    browser: true,
    es2020: true,
    'jest/globals': true,
  },
  plugins: ['react', 'react-hooks', '@typescript-eslint', 'jest'],
  extends: [
    'eslint:recommended',
    'plugin:react/recommended',
    'plugin:react-hooks/recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:jest/recommended',
  ],
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaFeatures: {
      jsx: true,
    },
    ecmaVersion: 12,
    sourceType: 'module',
  },
  globals: { module: 'readonly' },
  rules: {
    'newline-before-return': 'error',
    'no-console': 'warn',
    'no-continue': 'off',
    'require-yield': 'error',

    // ä¸­èº«ãŒãªã„ã‚¿ã‚°ã‚’é–‰ã˜ã‚‹
    'react/self-closing-comp': [
      'error',
      {
        component: true,
        html: true,
      },
    ],

    'react/prop-types': 'off',
  },
};
```
åŸºæœ¬çš„ã«ã¯å€‹åˆ¥ã®ãƒ«ãƒ¼ãƒ«ã‚’ã‚ã¾ã‚Šè¨­å®šã›ãšã€recommendedãªè¨­å®šã«ã—ã¾ã™ã€‚

ç¶šã‘ã¦ã€`.eslintignore`ã‚’ä½œæˆã—ã¾ã™ã€‚

```
$ touch .eslintignore
```
`.eslintignore`ã¯æ–‡å­—é€šã‚Šã€ESLintã®æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ã‹ã‚‰ç„¡è¦–ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚
```
node_modules/
*.config.js
```

# Prettier
Prettierã¯ã‚³ãƒ¼ãƒ‰ã®è¦‹ãŸç›®ã‚’ãã‚Œã„ã«æ•´ãˆã¦ãã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ESLintã¨å½¹å‰²ãŒä¼¼ã¦ã„ã¾ã™ãŒã€Prettierã¯æ§‹æ–‡ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚ã‘ã§ã¯ãªãã€ã‚¹ãƒšãƒ¼ã‚¹ã‚„æ”¹è¡Œã‚’ã„ã„æ„Ÿã˜ã«æ•´ãˆã¦ãã‚Œã‚‹ã ã‘ã§ã™ã€‚
ã¨ã¯ã„ãˆESLintã¨Prettierã¯è¦‹ã¦ã„ã‚‹å¯¾è±¡ãŒè¢«ã‚‹ã“ã¨ãŒå¤šã„ã®ã§ã€ESLintç”¨ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã†ã¾ãå…±å­˜ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ãã®ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è‰²ã€…ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ãã—ã¦`.prettierrc`ã‚‚ä½œæˆã—ã¾ã™ã€‚
```
$ yarn add -D prettier eslint-config-prettier eslint-plugin-prettier
$ touch .prettierrc
```

`.prettierrc`ã¯Prettierã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚
è‡ªåˆ†ã®å¥½ã¿ã«åˆã‚ã›ã¦è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚
```
{
  "bracketSpacing": true,
  "printWidth": 100,
  "semi": true,
  "singleQuote": true,
  "trailingComma": "all",
  "useTabs": false
}
```
`.eslintrc.js`ã«Prettierã¨ã®ä½µç”¨è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚
```js
module.exports = {
  env: {
    browser: true,
    es2020: true,
    'jest/globals': true,
  },
  plugins: ['react', 'react-hooks', '@typescript-eslint', 'prettier', 'jest'],
  extends: [
    'eslint:recommended',
    'plugin:react/recommended',
    'plugin:react-hooks/recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:jest/recommended',
    'plugin:prettier/recommended', // prettierã®è¨­å®šã¯ä¸€ç•ªä¸‹ã«
    'prettier',
    'prettier/@typescript-eslint',
    'prettier/react',
    'prettier/standard',
  ],
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaFeatures: {
      jsx: true,
    },
    ecmaVersion: 12,
    sourceType: 'module',
  },
  globals: { module: 'readonly' },
  rules: {
    'newline-before-return': 'error',
    'no-console': 'warn',
    'no-continue': 'off',
    'require-yield': 'error',

    // ä¸­èº«ãŒãªã„ã‚¿ã‚°ã‚’é–‰ã˜ã‚‹
    'react/self-closing-comp': [
      'error',
      {
        component: true,
        html: true,
      },
    ],

    'react/prop-types': 'off',

    // for prettier
    'prettier/prettier': [
      'error',
      {
        singleQuote: true,
        trailingComma: 'all',
      },
    ],
  },
};
```

æœ€å¾Œã«ã€`package.json`ã®`npm scripts`ã«ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚
```json
"lint": "yarn eslint src/**/*.tsx --fix",
```

# Jest
Jestã¯JavaScriptã®ãŸã‚ã®ãƒ†ã‚¹ãƒˆç”¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ã¡ãªã¿ã«Reactã¨åŒã˜ãFacebookãŒé–‹ç™ºã—ã¦ã„ã¾ã™ã€‚
`package.json`ã«Jestã®è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆã®ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’è¨ˆæ¸¬ã™ã‚‹å¯¾è±¡ã‚’æŒ‡å®šã™ã‚‹è¨­å®šã§ã™ã€‚
æœ€å¾Œã®è¡Œã¯Storybookã‚’ä½¿ã†å ´åˆã®è¨­å®šã§ã™ã€‚ä»Šå›ã¯å¿…è¦ã§ã¯ãªã„ã§ã™ãŒã‚«ãƒãƒ¬ãƒƒã‚¸ã«é–¢ä¿‚ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã‚“ãªæ„Ÿã˜ã§é™¤å¤–ã—ã¾ã™ã€‚
```json
"jest": {
  "collectCoverageFrom": [
    "src/**/components/**/*.{js,jsx,ts,tsx}",
    "src/**/container/**/*.{js,jsx,ts,tsx}",
    "!<rootDir>/node_modules/",
    "!src/**/*.stories.{js,jsx,ts,tsx}"
  ]
}
```
ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’è¨ˆæ¸¬ã™ã‚‹ãŸã‚ã®npm scriptsã‚‚è¿½åŠ ã—ã¾ã™ã€‚
```
"test:c": "react-scripts test --coverage --watchAll=false",
```

# husky & lint-staged
huskyã¯`git commit`ã‚„`git push`ã®éš›ã«ç™ºç”Ÿã™ã‚‹Gitãƒ•ãƒƒã‚¯ã‚’`package.json`ã§ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§ãã‚‹å„ªã‚Œã‚‚ã®ã§ã™ã€‚
ã“ã‚Œã§ã‚³ãƒŸãƒƒãƒˆã™ã‚‹å‰ã«`eslint --fix`ã—ãŸã„ã®ã§ã™ãŒã€ã“ã®ã¾ã¾ã ã¨`.eslintignore`ã§è¨­å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–å…¨ã¦ã‚’æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ã—ã¦ã—ã¾ã„ã€éåŠ¹ç‡çš„ã§ã™ã€‚
ã¨ã„ã†ã‚ã‘ã§lint-stagedã‚’ä½¿ã„ã¾ã™ã€‚lint-stagedã¯ã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã«ä»»æ„ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ã§ã¯æ—©é€Ÿã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
```
$ yarn add -D husky lint-staged
```
package.jsonã«ä»¥ä¸‹ã®è¨­å®šã‚’è¿½è¨˜
```json
"husky": {
    "hooks": {
      "pre-commit": "lint-staged"
    }
  },
  "lint-staged": {
    "src/**/*.{js,jsx,ts,tsx}": "eslint --fix"
  }
``` 

# ãŠã¾ã‘(VScode Settings)
ã“ã‚Œã¯VScodeã‚’ä½¿ã£ã¦ã„ã‚‹ç§ã®å¥½ã¿ã®è¨­å®šã§ã™ã€‚
```
$ mkdir .vscode && touch .vscode/settings.json
```

`.vscode/settings.json`ã«ä»¥ä¸‹ã®é€šã‚Šè¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚
```json
{
  "css.validate": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "editor.formatOnSave": true,
  "editor.tabSize": 2,
  "editor.wordWrap": "on",
  "eslint.enable": true,
  "eslint.packageManager": "yarn",
  "files.insertFinalNewline": true,
  "files.trimTrailingWhitespace": true,
  "typescript.tsdk": "node_modules/typescript/lib",
  "[markdown]": {
    "files.trimTrailingWhitespace": false
  }
}
```

## å‚è€ƒ
[Prettier å…¥é–€ ï½ESLintã¨ã®é•ã„ã‚’ç†è§£ã—ã¦ä½µç”¨ã™ã‚‹ï½](https://qiita.com/soarflat/items/06377f3b96964964a65d)